#!/bin/sh
#
# This script starts and stops memcached from monit
# This script belongs in /engineyard/bin/monit_memcached
PATH=/bin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:$PATH

usage() {
  echo "Usage: $0 <memcachedname> {start, stop}"
  echo "Memcachedname is the name of the start script in /etc/init.d/"
  echo "Unless you run more than one memcached on your slice, just use memcached"
  exit 1
}

if [ $# -lt 2 ]; then usage; fi

if [ -e /etc/init.d/$1 ]; then
  # handle the second param, don't start if already existing
  case "$2" in
    start)
      /etc/init.d/$1 start
      ;;
    stop)
      /etc/init.d/$1 stop
      sleep 5
      /etc/init.d/$1 zap
      ;;
    *)
      usage
      ;;
	esac
else
  echo "/etc/init.d/$1 doesn't exist."
  usage
fi
